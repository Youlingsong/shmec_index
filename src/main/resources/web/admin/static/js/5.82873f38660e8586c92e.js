webpackJsonp([5],{"+5SY":function(t,e){},"+Hxm":function(t,e){},"/iyE":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("woOf"),i=a.n(s),r=a("Xxa5"),l=a.n(r),o=a("exGp"),n=a.n(o),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{ref:"formValidate",attrs:{model:t.formValidate,"label-width":80}},[a("Row",[a("Col",{attrs:{span:8}},[a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{attrs:{placeholder:"请输入新闻标题..."},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1)],1),t._v(" "),a("Col",{attrs:{span:5}},[a("FormItem",{attrs:{label:"是否显示",prop:"publishFlag"}},[a("Select",{attrs:{placeholder:"请选择是否在首页显示...",clearable:""},model:{value:t.formValidate.publishFlag,callback:function(e){t.$set(t.formValidate,"publishFlag",e)},expression:"formValidate.publishFlag"}},t._l(t.options.publishFlag,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.text))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:5}},[a("FormItem",{attrs:{label:"状态",prop:"status"}},[a("Select",{attrs:{placeholder:"请选择状态...",clearable:""},model:{value:t.formValidate.status,callback:function(e){t.$set(t.formValidate,"status",e)},expression:"formValidate.status"}},t._l(t.options.status,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.text))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:6}},[a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("确定")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]},c=a("VU/8")({data:function(){return{options:{publishFlag:[{text:"显示",value:1},{text:"不显示",value:2}],status:[{text:"发布",value:1},{text:"草稿",value:2}]},formValidate:{title:"",publishFlag:"",status:""}}},methods:{handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t?e.$emit("initList",e.formValidate):e.$Message.error("搜索条件有误")})},handleReset:function(t){this.$refs.formValidate.resetFields(),this.$emit("initList",this.formValidate)}}},d,!1,null,null,null).exports,u=(a("BTaQ"),{components:{queryForm:c},created:function(){this.loadListData()},data:function(){var t=this;return{isAdd:!1,ismodify:!1,editList:{},list:[],loading:!1,columns:[{title:"标题图",key:"titleImageUrl",align:"center",render:function(t,e){return t("img",{attrs:{src:e.row.titleImageUrl},style:{"max-width":"50px","max-height":"50px"}})}},{title:"标题",key:"title",ellipsis:"true",align:"center"},{title:"作者",align:"center",key:"author",render:function(t,e){return t("div",[t("span","null"===e.row.author?"":e.row.author)])}},{title:"来源",align:"center",key:"source",render:function(t,e){return t("div",[t("span","null"===e.row.source?"":e.row.source)])}},{title:"分类",align:"center",key:"classes"},{title:"简介",align:"center",ellipsis:"true",key:"summary",render:function(t,e){return t("div",[t("span","null"===e.row.summary?"":e.row.summary)])}},{title:"首页是否显示",align:"center",key:"publishFlag",sortable:!0,render:function(t,e){return t("div",[t("span",1==+e.row.publishFlag?"显示":"不显示")])}},{title:"状态",align:"center",key:"status",sortable:!0,render:function(t,e){return t("div",[t("span",1==+e.row.status?"发布":"草稿")])}},{title:"优先级",align:"center",key:"priority"},{title:"发布时间",align:"center",key:"publishTime",sortable:!0,render:function(t,e){return t("div",[t("span",e.row.publishTime.split(" ")[0])])}},{title:"操作",key:"action",width:300,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editRow(a)}}},"修改"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.removeRow(a)}}},"删除")])}}],params:{pageNumber:1,pageSize:10},total:0,url:{remove:this.projectName+"/mgmt/news/delete.do"}}},methods:{addRow:function(){this.editList={title:"",author:"",source:"",classesId:"",summary:"",publishFlag:"2",publishTime:"",content:"",priority:1,titleImageUrl:"",status:2},this.$emit("addNews",{info:this.editList,flag:!0})},editRow:function(t){var e=this;return n()(l.a.mark(function a(){var s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$ajaxPost(e.projectName+"/mgmt/news/find.do",{id:t.row.id});case 2:s=a.sent,e.editList={id:s.id,title:s.title,author:"null"===s.author?"":s.author,source:"null"===s.source?"":s.source,classesId:s.classesId,summary:"null"===s.summary?"":s.summary,publishFlag:s.publishFlag,publishTime:s.publishTime,content:s.content,priority:Number(s.priority),titleImageUrl:s.titleImageUrl,status:Number(s.status)},e.$emit("modifyNews",{info:e.editList,flag:!0});case 5:case"end":return a.stop()}},a,e)}))()},removeRow:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"<p>确定删除该条数据么？</p>",loading:!0,onOk:function(){e.$ajaxPost(e.url.remove,{id:t.row.id}).then(function(t){e.$Modal.remove(),e.$Message.success("删除成功"),e.loadListData()})}})},loadListData:function(t){var e=this;this.params=t?i()({},this.params,t):this.params,this.loading=!0,this.$ajaxPost(this.projectName+"/mgmt/news/finds.do",i()({},this.params)).then(function(t){e.loading=!1,e.list=t.rows,e.total=t.total})},pageChange:function(t){this.params.pageNumber=t,this.loadListData()}}}),m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("query-form",{on:{initList:t.loadListData}}),t._v(" "),a("Table",{attrs:{columns:t.columns,data:t.list,loading:t.loading,"no-data-text":"没有满足条件的数据."}},[a("Button",{staticClass:"m-marlr",attrs:{slot:"header",type:"ghost"},on:{click:t.addRow},slot:"header"},[t._v("新增")])],1),t._v(" "),a("Page",{staticClass:"page",attrs:{total:t.total,"show-total":""},on:{"on-change":t.pageChange}})],1)},staticRenderFns:[]};var f=a("VU/8")(u,m,!1,function(t){a("5RFY")},null,null).exports,p=a("PJh5"),h=a.n(p),g={props:["isAdd","formValidate","modify"],data:function(){var t=this;return{tagColors:["blue","green","red","yellow"],options:{classes:[],publishFlag:[{text:"显示",value:"1"},{text:"不显示",value:"2"}],status:[{text:"发布",value:1},{text:"草稿",value:2}]},ruleValidate:{title:[{required:!0,message:"请输入标题...",trigger:"blur"}],publishTime:{required:!0,type:"date",message:"请选择发布时间...",trigger:"change"},classesId:{required:!0,trigger:"change",validator:function(e,a,s){t.formValidate.classesId?s():s(new Error("请选择分类..."))}},publishFlag:{required:!0,validator:function(e,a,s){t.formValidate.publishFlag?s():s(new Error("请选择是否在首页显示..."))},trigger:"change"},status:{required:!0,validator:function(e,a,s){t.formValidate.status?s():s(new Error("请选择是否发布..."))},trigger:"change"},content:{required:!0},priority:{validator:function(e,a,s){1!=+t.formValidate.publishFlag||t.formValidate.priority?s():s(new Error("请填写首页显示优先级，数值越低，优先级越高"))},trigger:"blur"}}}},created:function(){this.getSource()},computed:{defaultList:function(){return this.formValidate.titleImageUrl?[{url:this.formValidate.titleImageUrl,name:this.formValidate.titleImageUrl}]:[]}},methods:{onEditorChange:function(t){this.formValidate.content=t},getSource:function(){var t=this;this.$ajaxPost(this.projectName+"/mgmt/news/findClassesList.do").then(function(e){t.options.classes=e})},addSubmit:function(){var t=this;this.$ajaxPost(this.projectName+"/mgmt/news/save.do",this.formValidate).then(function(e){t.$Message.success("恭喜你，新增新闻成功!"),t.$emit("cancelAdd"),t.$refs.formValidate.resetFields(),t.$emit("getList")})},modifySubmit:function(){var t=this;this.$ajaxPost(this.projectName+"/mgmt/news/update.do",this.formValidate).then(function(e){t.$Message.success("恭喜你，新闻修改成功!"),t.$emit("cancelAdd"),t.$refs.formValidate.resetFields(),t.$emit("getList")})},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t)e.formValidate.publishTime=h()(e.formValidate.publishTime).format("YYYY-MM-DD"),e.modify?e.modifySubmit():e.addSubmit();else{var a=e.modify?"修改":"新增";e.$Message.error(a+"新闻失败，请刷新后重新尝试")}})},handleReset:function(t){this.$emit("cancelAdd"),this.$refs.formValidate.resetFields()},uploadS:function(t,e,a){e.response.error?this.$Message.error("上传失败，请重新上传"):(this.$Message.success("上传成功！"),this.formValidate.titleImageUrl=e.response.message.url)},uploadE:function(t,e,a){this.$Message.error(t)},beforeUpload:function(t){return-1===t.type.indexOf("image")?(this.$Message.error("请选择图片文件进行上传"),!1):this.formValidate.titleImageUrl?(this.$Message.error("如果想上传新的文件，请先点击文件右侧进行删除后再重新上传！"),!1):void 0},removeUpload:function(t,e){this.formValidate.titleImageUrl=""}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"top"},[a("Button",{attrs:{icon:"ios-arrow-back"},on:{click:t.handleReset}},[t._v("返回")])],1),t._v(" "),a("Form",{ref:"formValidate",staticClass:"form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":120}},[a("FormItem",{attrs:{label:"标题图",prop:"titleImageUrl"}},[a("Upload",{attrs:{action:t.projectName+"/file/fileUpload.do?fileName=newsImage&locker=6f0c077ee53d4aa68b9eae5b3e853bb8",name:"data",accept:"image/*","on-success":t.uploadS,"on-error":t.uploadE,"before-upload":t.beforeUpload,"on-remove":t.removeUpload,"default-file-list":t.defaultList},model:{value:t.formValidate.titleImageUrl,callback:function(e){t.$set(t.formValidate,"titleImageUrl",e)},expression:"formValidate.titleImageUrl"}},[a("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[t._v("点击上传")])],1),t._v(" "),a("span",{staticStyle:{color:"#f56c6c"}},[t._v("建议图片比例16:9")])],1),t._v(" "),a("FormItem",{attrs:{label:"标题",prop:"title"}},[a("Input",{attrs:{placeholder:"请输入标题..."},model:{value:t.formValidate.title,callback:function(e){t.$set(t.formValidate,"title",e)},expression:"formValidate.title"}})],1),t._v(" "),a("FormItem",{attrs:{label:"作者",prop:"author"}},[a("Input",{attrs:{placeholder:"请输入作者名称..."},model:{value:t.formValidate.author,callback:function(e){t.$set(t.formValidate,"author",e)},expression:"formValidate.author"}})],1),t._v(" "),a("FormItem",{attrs:{label:"来源",prop:"source"}},[a("Input",{attrs:{placeholder:"请输入新闻来源..."},model:{value:t.formValidate.source,callback:function(e){t.$set(t.formValidate,"source",e)},expression:"formValidate.source"}})],1),t._v(" "),a("FormItem",{attrs:{label:"分类",prop:"classesId"}},[a("Select",{attrs:{placeholder:"请选择分类...",filterable:""},model:{value:t.formValidate.classesId,callback:function(e){t.$set(t.formValidate,"classesId",e)},expression:"formValidate.classesId"}},t._l(t.options.classes,function(e){return a("Option",{key:e.classesId,attrs:{value:e.classesId}},[t._v(t._s(e.classes))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"是否发布",prop:"status"}},[a("Select",{attrs:{placeholder:"请选择是否发布..."},model:{value:t.formValidate.status,callback:function(e){t.$set(t.formValidate,"status",e)},expression:"formValidate.status"}},t._l(t.options.status,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.text))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"是否显示在首页",prop:"publishFlag"}},[a("Select",{attrs:{placeholder:"请选择是否在首页显示..."},model:{value:t.formValidate.publishFlag,callback:function(e){t.$set(t.formValidate,"publishFlag",e)},expression:"formValidate.publishFlag"}},t._l(t.options.publishFlag,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.text))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"首页显示优先级",prop:"priority"}},[a("InputNumber",{attrs:{max:20,min:1},model:{value:t.formValidate.priority,callback:function(e){t.$set(t.formValidate,"priority",e)},expression:"formValidate.priority"}}),a("span",{staticClass:"hint-txt"},[t._v("(注：数值从1至20，数值越低，优先级越高)")])],1),t._v(" "),a("FormItem",{attrs:{label:"发布时间",prop:"publishTime"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择发布时间...",format:"yyyy-MM-dd"},model:{value:t.formValidate.publishTime,callback:function(e){t.$set(t.formValidate,"publishTime",e)},expression:"formValidate.publishTime"}})],1),t._v(" "),a("FormItem",{attrs:{label:"简介",prop:"summary"}},[a("Input",{attrs:{placeholder:"请输入简介..."},model:{value:t.formValidate.summary,callback:function(e){t.$set(t.formValidate,"summary",e)},expression:"formValidate.summary"}})],1),t._v(" "),a("FormItem",{attrs:{label:"内容",prop:"content"}},[a("editor",{attrs:{id:"editor_id",height:"500px",width:"100%",content:t.formValidate.content,pluginsPath:"/static/kindeditor/plugins/",loadStyleMode:!1,resizeType:1,wellFormatMode:!1,allowFileManager:!0,uploadJson:t.projectName+"/editor/file/fileUpload.do?locker=6f0c077ee53d4aa68b9eae5b3e853bb8"},on:{"on-content-change":t.onEditorChange}})],1)],1),t._v(" "),a("div",{staticClass:"footer-btn",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v(t._s(t.modify?"修改":"新增"))]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.handleReset}},[t._v("取消")])],1)],1)},staticRenderFns:[]};var y={components:{list:f,add:a("VU/8")(g,v,!1,function(t){a("+Hxm")},"data-v-4d9f95e0",null).exports},data:function(){return{currentView:"list",isAdd:!1,isModify:!1,formValidate:{}}},methods:{addNews:function(t){var e=t.info,a=t.flag;this.formValidate=e,this.isAdd=a,this.isModify=!a,this.currentView=a?"add":"list"},modifyNews:function(t){var e=t.info,a=t.flag;this.formValidate=e,this.isAdd=a,this.isModify=a,this.currentView=a?"add":"list"},cancelAdd:function(){this.isAdd=!1,this.currentView="list"}}},b={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e(this.currentView,{tag:"component",attrs:{isAdd:this.isAdd,modify:this.isModify,formValidate:this.formValidate},on:{addNews:this.addNews,modifyNews:this.modifyNews,cancelAdd:this.cancelAdd}})],1)},staticRenderFns:[]},V=a("VU/8")(y,b,!1,null,null,null);e.default=V.exports},"5RFY":function(t,e){},"O+iB":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),r=a("exGp"),l=a.n(r),o={data:function(){var t=this;return{parentClasses:"",parentList:[],allList:[],clickId:null,addClassesModel:!1,formValidate:{classes:"",parentId:0},modify:!1,ruleValidate:{classes:[{required:!0,message:"输入分类名称...",trigger:"blur"}]},list:[],loading:!1,textTips:"暂无数据",columns:[{title:"二级分类名称",key:"classes",align:"center"},{title:"操作",key:"action",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.editRow(a)}}},"修改"),e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.removeRow(a.row)}}},"删除")])}}]}},created:function(){this.getParentList()},methods:{getParentList:function(){var t=this;return l()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$ajaxPost(t.projectName+"/mgmt/news/findClassesList.do");case 2:a=e.sent,t.allList=a,t.parentList=a.filter(function(t){return 0===t.parentId});case 5:case"end":return e.stop()}},e,t)}))()},clickRadio:function(t){var e=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.clickId=t,e.list=e.allList.filter(function(t){return t.parentId===e.clickId});case 2:case"end":return a.stop()}},a,e)}))()},addClassify:function(){this.addClassesModel=!0,this.modify=!1,this.formValidate={classes:"",parentId:0}},modifyClassify:function(){var t=this,e=this.parentList.filter(function(e){return e.classesId===t.clickId})[0];this.formValidate={classes:e.classes,parentId:0,classesId:this.clickId},this.removeRow(this.formValidate)},removeRow:function(t){var e=this,a=Boolean(0===t.parentId);this.$Modal.confirm({title:"提示",content:a?"<p>此操作会删除该分类下所有分类，是否继续?</p>":"<p>删除该分类，是否继续?</p>",loading:!0,onOk:function(){e.$ajaxPost(e.projectName+"/mgmt/news/deleteNewsClasses.do",{classesId:t.classesId}).then(function(t){e.$Message.success("删除成功！"),e.$Modal.remove(),e.getParentList(),a?(e.parentClasses="",e.list=[]):e.clickRadio(e.clickId)}).catch(function(t){e.$Message.warning("删除失败，请重新删除")})}})},handleSubmit:function(t){var e,a=this;this.$refs[t].validate((e=l()(i.a.mark(function e(s){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=11;break}return e.next=3,a.$ajaxPost(a.modify?a.projectName+"/mgmt/news/updateNewsClasses.do":a.projectName+"/mgmt/news/saveNewsClasses.do",a.formValidate);case 3:e.sent,a.$Message.success(a.modify?"修改成功!":"新增成功!"),a.getParentList(),a.addClassesModel=!1,a.clickRadio(a.clickId),a.handleReset(t),e.next=12;break;case 11:a.$Message.error("填写有误，请检查后进行下一步操作!");case 12:case"end":return e.stop()}},e,a)})),function(t){return e.apply(this,arguments)}))},handleReset:function(t){this.$refs[t].resetFields(),this.addClassesModel=!1},addRow:function(){this.addClassesModel=!0,this.modify=!1,this.formValidate.parentId=this.clickId},editRow:function(t){var e=t.row;this.addClassesModel=!0,this.modify=!0,this.formValidate={classes:e.classes,classesId:e.classesId,parentId:e.parentId}}},watch:{allList:{handler:function(t,e){var a=this;this.list=t.filter(function(t){return t.parentId===a.clickId})},deep:!0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"department-manage"},[a("h3",[t._v("分类")]),t._v(" "),a("Row",[a("Col",{attrs:{span:"19"}},[a("RadioGroup",{on:{"on-change":t.clickRadio},model:{value:t.parentClasses,callback:function(e){t.parentClasses=e},expression:"parentClasses"}},t._l(t.parentList,function(e){return a("Radio",{key:e.classesId,staticClass:"radio-list",attrs:{label:e.classesId}},[t._v(t._s(e.classes))])}))],1),t._v(" "),a("Col",{staticStyle:{"text-align":"center"},attrs:{span:"5"}},[a("Button",{attrs:{size:"small",disabled:""===t.parentClasses},on:{click:t.modifyClassify}},[t._v("删除一级分类")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{size:"small",type:"primary",ghost:""},on:{click:t.addClassify}},[t._v("添加一级分类")])],1)],1),t._v(" "),a("Table",{ref:"selection",staticStyle:{"margin-top":"20px"},attrs:{columns:t.columns,data:t.list,loading:t.loading,"no-data-text":t.textTips}},[a("Button",{staticClass:"m-marlr",attrs:{slot:"header",type:"ghost",disabled:""===t.parentClasses},on:{click:t.addRow},slot:"header"},[t._v("新增")])],1),t._v(" "),a("Modal",{attrs:{title:t.modify?"修改":"添加","mask-closable":!1,closable:!1},model:{value:t.addClassesModel,callback:function(e){t.addClassesModel=e},expression:"addClassesModel"}},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":50}},[a("FormItem",{attrs:{label:"名称",prop:"classes"}},[a("Input",{attrs:{type:"text",placeholder:"请输入名称"},model:{value:t.formValidate.classes,callback:function(e){t.$set(t.formValidate,"classes",e)},expression:"formValidate.classes"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v(t._s(t.modify?"修改":"新增"))]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:function(e){t.handleReset("formValidate")}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(o,n,!1,function(t){a("+5SY")},"data-v-4e32b688",null);e.default=d.exports}});
//# sourceMappingURL=5.82873f38660e8586c92e.js.map